<!DOCTYPE html>
<html lang="en-nz">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    
    <title>Diary of a Game Part 5: Wha&#39; happen? | Ziggurat</title>
    <meta name="description" content="Occasional ramblings about retro games, development, augmented reality and other random subjects.">
    <meta name="author" content="">
    
    <link rel="apple-touch-icon" sizes="180x180" href=http://localhost:1313/apple-touch-icon.png>
    <link rel="icon" type="image/png" sizes="32x32" href=http://localhost:1313/favicon-32x32.png>
    <link rel="icon" type="image/png" sizes="16x16" href=http://localhost:1313/favicon-16x16.png>
    <link rel="manifest" href=http://localhost:1313/site.webmanifest>
    <link rel="mask-icon" href=http://localhost:1313/safari-pinned-tab.svg color="#00416a">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">
    
    <meta name="omgproof" content="proven.lol/df002d">
    
    
    <link rel="me" href="mailto:mike@ziggurat.co.nz">
    
    
    
    
    <link rel="stylesheet" href=http://localhost:1313/css/fonts.css />
    <link rel="stylesheet" href=http://localhost:1313/css/style.css />
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div id="sitelogo">
        <a class="glyph" alt="Home" href="http://localhost:1313/"><img src=http://localhost:1313/images/Ziggurat%20Logo%20Symbol.svg alt="Site Logo" height="64px" width="64px"></a>
    </div>
    <header>
        <nav>
    
    <div id="page-nav">
        <div class="page-nav-item">
            <a href="http://localhost:1313/">Home</a>
        </div>
        
            <div class="page-nav-item">
                <a href="/confidential/">
                    
                    <span>Confidential Magazine</span>
                </a>
            </div>
        
            <div class="page-nav-item">
                <a href="/about/">
                    
                    <span>About</span>
                </a>
            </div>
        
    </div>
</nav>
        
    </header>






<div id="content">
    <article class="h-entry">
        <header>
            <h1 class="post-title p-name">Diary of a Game Part 5: Wha&#39; happen?</h1>
            <p class="post-date">Posted on
                <time class="dt-published" datetime="15 September 2020 09:11 NZST">
                    15 September 2020 09:11 NZST
                </time>  by <a href="http://localhost:1313/" class="p-author h-card"
                    rel="author">Michael Keith</a>
            </p>
            
            
            <p class="post-tag">Category:
                
                <a href="http://localhost:1313//categories/diary-of-a-game" class="post-tag p-category">Diary of a game</a>
                
            </p>
            <hr class="post-underline">
            
        </header>
        <section class="content e-content">
            <p>
<iframe class="embedly-embed"
src="//cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FNYVLnHYWIdw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DNYVLnHYWIdw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FNYVLnHYWIdw%2Fhqdefault.jpg&key=61d05c9d54e8455ea7a9677c366be814&type=text%2Fhtml&schema=youtube&wmode=opaque"
width="640" height="480" scrolling="no" title="YouTube embed" frameborder="0"
allow="autoplay; fullscreen" allowfullscreen="true"></iframe>


<iframe width="560" height="315"
src="https://www.youtube.com/embed/NYVLnHYWIdw" frameborder="0"
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-
picture" allowfullscreen></iframe>
</p>
<p>Ahh boy. I just checked when the last instalment of this was, thinking it had
to have been mid-2019, but instead it was in fact in <a href="/news/2019/2/24/diary-of-a-game-part-4-item-activation-interpolation-and-bugs">February 2019</a> üò±</p>
<p>Wha‚Äô happen? Well, work was crazy busy throughout most of last year. I managed
to squeeze in a lovely holiday trip back to London, after which it was
straight on a plane to spend 2-3 weeks with the Sunnyvale office (and when I
say ‚Äústraight on a plane‚Äù I mean I literally had 1 day at home after the
gruelling journey back from London before flying out). The rest of 2019 was a
bit of blur, mainly due to work. Then things got proper surreal in March with
Covid, lockdown and, well, <a href="/news/2020/5/7/well-that-was-quite-a-ride">being laid off</a> a short time into it.</p>
<p>Despite that and the fact that - thanks to sterling efforts by my old Magic
Leap teammates - it wasn‚Äôt long before we started picking up contract work, I
have actually made progress on this little puzzle game in my spare time. Well,
‚Äúprogress‚Äù may be too strong of a word.</p>
<p>Things slowed quite a bit for a while around this time last year as I hit a
really tricky bug which took me ages to find, but turned out to be a simple
off by one error.</p>
<p>Since the last update the following changes have gone in:</p>
<ul>
<li>Sprites are now used to interpolate moving items</li>
<li>Added ‚Äúimposters‚Äù which are basically fake items that have no logical significance, but are used to prevent blank spaces when interpolating moving items.</li>
<li>Rounds can now be loaded from stored data generated by an external tool.</li>
<li>Started writing said tool in Python to lay out rounds.</li>
<li>Added the concept of a HUD which currently just shows the colour of the next item the player will get.</li>
<li>Completely re-did how I was handling memory (which was terrible)‚Ä¶ now moved over to use consistent segments for code &amp; data.</li>
<li>Created a new system for implementing game phases/states which means it‚Äôs easy to add a new phase with little changes to the code.</li>
<li>Added a toggle-able debug HUD with debug printing routines.</li>
<li>The next item colour the player gets is now chosen from only those colours remaining on the board.</li>
<li>A round can now be cleared, which results in starting the next round.</li>
<li>After a certain number of shots, the height the player fires from drops down a row (making it harder).</li>
<li>If the player‚Äôs fired item starts on top of an existing item then it‚Äôs game over.</li>
<li>Items can now bubble upwards and disappear when they reach the top, which will be used for‚Ä¶ bubble items.</li>
<li>A fair amount of refactoring and some minor optimising.</li>
</ul>
<p>If that looks like a lot of stuff then never fear: the game still looks as
crap as ever with my not even half arsed use of the standard character set.</p>
<p><img src="/images/2020-09-14-2020915diary-of-a-game-part-5-wha-happen/image-asset.png" alt="The toggle-able debug HUD."></p>
<p>The toggle-able debug HUD.</p>
<p>It‚Äôs actually something resembling an actual game now, which is great. One
aspect that really sucks is that it is in sore need of a proper optimisation
pass. That may require a significant refactor of how the board &amp; item states
are stored in memory, so I have, naturally, been kicking that can down the
road.</p>
<p>I‚Äôm not terribly happy with the way I currently draw the board and items, as
it requires setting the horizontal scroll registers every 8 lines (which
happen to be <a href="https://nurpax.github.io/posts/2018-06-19-bintris-on-c64-part-5.html" title="Great explaination of bad lines">‚Äúbad lines‚Äù</a>). I spent a little time looking at
stabilising the raster but I <em>think</em> I will need to do that every time I need
to set the scroll register. Maybe that‚Äôs fine?</p>
<p>One of my more embarrassing dead ends recently was thinking I could just use
multi colour chars (for the regular item positions plus ones for the offset
rows). This would remove the need for setting the scroll register, and
simplify a bunch of things. I set about creating a custom character set, which
was looking good.. but then it finally dawned on me that while that gives you
4 colours, each char can still only have one individual colour, and it really
needs to support 4-6 differently coloured items. D‚Äôoh.</p>
<p>I plan (‚Äúplan‚Äù) to post more details about the changes and the ‚Äúprogress‚Äù</p>

        </section>
        <footer>
            <a class="permalink u-url" href="http://localhost:1313/news/2020/9/15/diary-of-a-game-part-5-wha-happen/">üîó</a>
            
            <hr class="post-underline">
            <p class="post-tag">Tags for this post:
                
                <a href="http://localhost:1313/tags/c64" class="post-tag p-category">C64</a>
                
                <a href="http://localhost:1313/tags/assembler" class="post-tag p-category">Assembler</a>
                
                <a href="http://localhost:1313/tags/coding" class="post-tag p-category">Coding</a>
                
            </p>
            
        </footer>
    </article>
</div>

    
    <div id="footer">
      
      <nav id="article-skip">
        <div class="next">
          
          <a alt="Newer article" href="http://localhost:1313/news/2020/9/29/this-month-in-the-one-94/">&larr; Newer</a>
          
        </div>
        <div class="top">
          <a alt="Top of page" href="#">Top</a>
        </div>
        <div class="prev">
          
          <a alt="Older article" href="http://localhost:1313/news/2020/8/25/this-month-in-the-one-94/">Older &rarr;</a>
          
        </div>
      </nav>
      
      <aside id="social">
  <div id="social-icons">
    
    <div class="icon-24x24">
      <a class="glyph" alt="Email me" href="mailto:mike@ziggurat.co.nz"><img src=http://localhost:1313/icons/envelope.svg height="24px" width="24px"></a>
    </div>
    
    
    <div class="icon-24x24">
      <a rel="me" class="glyph" alt="Mastodon profile" href="https://icosahedron.website/@nifta"><img src=http://localhost:1313/icons/mastodon.svg height="24px" width="24px"></a>
     </div>
     
    
    
    
    <div class="icon-24x24">
      <a class="glyph" alt="GitHub profile" href="https://github.com/mikekeith"><img src=http://localhost:1313/icons/github.svg height="24px" width="24px"></a>
    </div>
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
</aside>

      
      <p class="copyright">
          Copyright ¬© 2022, Ziggurat Development Ltd
      </p>
      
    </div>


</body>
</html>